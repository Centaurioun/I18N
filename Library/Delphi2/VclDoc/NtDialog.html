<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<title>Soluling's VCL Classes: NtDialog</title>
<link rel="StyleSheet" type="text/css" href="pasdoc.css">
</head>
<body bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#800080" alink="#FF0000">
<h1 class="unit">Unit NtDialog</h1>
<table class="sections wide_list">
<tr>
<td><a class="section"  href="#%40Description">Description</a></td><td>Uses</td><td><a class="section"  href="#%40Classes">Classes, Interfaces, Objects and Records</a></td><td>Functions and Procedures</td><td><a class="section"  href="#%40Types">Types</a></td><td>Constants</td><td>Variables</td></tr></table>
<a name="%40Description"></a><h2 class="description">Description</h2>
<p>
Implements class that formats filter string for TOpenDialog and TSaveDialog.</p>
<p>


<p>If you set the whole filter string into one single resource string the format of string is quite complicated. For example.

<p></p>

<pre class="longcode">
  All supported files <span class="pascal_comment">(*.xml;*.ini)|*.xml;*.ini|XML files (*.xml)|*.xml|Ini files (*.ini)|*.ini
</span></pre>

<p>

<p>It is likely that translator will break the above format and your localized application will crash when the incorrect filter string is assigned to dialog's Filter property. Use this class to break the complicated string into plain string that are easy and safe to translate. Instead of one complex string we will have three simple strings to be translated.

<p></p>

<pre class="longcode">
  All supported files
  XML files
  Ini files
</pre>

<p>

<p>There is no possibility to break the filter format my entering invalid translations. See the following code about how ti use the class.

<p></p>

<pre class="longcode">
<span class="pascal_keyword">resourcestring</span>
  SAllSupportedFiles = <span class="pascal_string">'All supported files'</span>;
  SXmlFiles = <span class="pascal_string">'XML files'</span>;
  SIniFiles = <span class="pascal_string">'Ini files'</span>;
<span class="pascal_keyword">var</span>
  dialog: TOpenDialog;
  filter: TNtDialogFilter;
<span class="pascal_keyword">begin</span>
  dialog := TOpenDialog.Create(<span class="pascal_keyword">nil</span>);
  <span class="pascal_keyword">try</span>
    dialog.Title := SOpenTitle;

    filter := TNtDialogFilter.Create;
    <span class="pascal_keyword">try</span>
      filter.Supported(SAllSupportedFiles);
      filter.Add(SXmlFiles, <span class="pascal_string">'xml'</span>);
      filter.Add(SIniFiles, <span class="pascal_string">'ini'</span>);
      filter.All(SAllFiles);

      dialog.Filter := filter.Value;
    <span class="pascal_keyword">finally</span>
      filter.Free;
    <span class="pascal_keyword">end</span>;

    <span class="pascal_keyword">if</span> dialog.Execute <span class="pascal_keyword">then</span>
      ShowMessage(dialog.FileName);
  <span class="pascal_keyword">finally</span>
    dialog.Free;
  <span class="pascal_keyword">end</span>;
</pre>

<p>

<p>When you create <a class="normal"  href="NtDialog.TNtDialogFilter.html">TNtDialogFilter</a> you have to call <a class="normal"  href="NtDialog.TNtDialogFilter.html#Add">TNtDialogFilter.Add</a> method as least once. <a class="normal"  href="NtDialog.TNtDialogFilter.html#Supported">TNtDialogFilter.Supported</a> and <a class="normal"  href="NtDialog.TNtDialogFilter.html#All">TNtDialogFilter.All</a> are optional.

<p>See <i>Samples\Delphi\VCL\FileDialog</i> sample to see how to use the unit.</p>
<a name="%40Uses"></a><h2 class="overview">Overview</h2>
<a name="%40Classes"></a><h3 class="cio">Classes, Interfaces, Objects and Records</h3>
<table class="classestable wide_list">
<tr class="listheader">
<th class="itemname">Name</th>
<th class="itemdesc">Description</th>
</tr>
<tr class="list">
<td class="itemname">Class&nbsp;<a class="bold"  href="NtDialog.TNtDialogFilter.html"><code>TNtDialogFilter</code></a></td>
<td class="itemdesc">Dialog filter formatter class.</td>
</tr>
</table>
<a name="%40Types"></a><h3 class="summary">Types</h3>
<table class="summary wide_list">
<tr class="list">
<td class="itemcode"><code><b><a   href="NtDialog.html#TNtDialogFilterPosition">TNtDialogFilterPosition</a></b> = (...);</code></td>
</tr>
</table>
<h2 class="description">Description</h2>
<h3 class="detail">Types</h3>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TNtDialogFilterPosition"></a><code><b>TNtDialogFilterPosition</b> = (...);</code></td>
</tr>
<tr><td colspan="1">
&nbsp;<h6 class="description_section">Values</h6>
<ul>
<li>
fpNone: &nbsp;</li>
<li>
fpFirst: &nbsp;</li>
<li>
fpLast: &nbsp;</li>
</ul>
</td></tr>
</table>
</body></html>
